const { createWriteStream } = require('fs');
const path = require('path');

// 创建一个简单的PNG图标（1x1像素的蓝色方块）
const createSimpleIcon = () => {
  const iconPath = path.join(__dirname, 'icon.png');
  
  // 这是一个最小的PNG文件（1x1像素的蓝色方块）
  const pngData = Buffer.from([
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG signature
    0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52, // IHDR chunk start
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, // 1x1 pixels
    0x08, 0x02, 0x00, 0x00, 0x00, 0x90, 0x77, 0x53, // 8-bit RGBA
    0xDE, 0x00, 0x00, 0x00, 0x0C, 0x49, 0x44, 0x41, 0x54, // IDAT chunk start
    0x08, 0x99, 0x01, 0x01, 0x00, 0x00, 0x00, 0xFE, 0xFF, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, // Image data
    0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42, 0x60, 0x82 // IEND chunk
  ]);
  
  const writeStream = createWriteStream(iconPath);
  writeStream.write(pngData);
  writeStream.end();
  
  console.log('Simple icon created at:', iconPath);
};

// 如果图标不存在，创建一个
const fs = require('fs');
if (!fs.existsSync(path.join(__dirname, 'icon.png'))) {
  createSimpleIcon();
}

module.exports = { createSimpleIcon };